<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yanggy.kotlin.dao.UserMapper">

    <sql id="base_columns">
        id, user_name as userName, birth, sex, avatar, email, password, phone
    </sql>
    <select id="findByName" parameterType="java.lang.String" resultType="com.yanggy.kotlin.entity.User">
        select <include refid="base_columns"/>
        from user
        <where>
            user_name = #{name}
        </where>
    </select>

    <select id="getUserRoles" parameterType="java.lang.Long" resultType="java.lang.String">
        select p.name
        from user_role ur
        join role_permission rp on rp.role_id = ur.role_id
        join permisions p on p.id = rp.permission_id
        where ur.user_id = #{id}
    </select>
</mapper>